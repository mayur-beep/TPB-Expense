<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TBP Media - Expense Command Center v2</title>
    <link href="https://fonts.googleapis.com/css2?family=Instrument+Sans:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --bg-primary: #0a0a0f;
            --bg-secondary: #12121a;
            --bg-card: #1a1a24;
            --bg-card-hover: #22222e;
            --border-color: #2a2a38;
            --border-subtle: #1f1f2a;
            --text-primary: #f5f5f7;
            --text-secondary: #8b8b9e;
            --text-muted: #5a5a6e;
            --accent-primary: #6366f1;
            --accent-secondary: #8b5cf6;
            --accent-gradient: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            --success: #10b981;
            --success-bg: rgba(16, 185, 129, 0.1);
            --warning: #f59e0b;
            --warning-bg: rgba(245, 158, 11, 0.1);
            --danger: #ef4444;
            --danger-bg: rgba(239, 68, 68, 0.1);
            --info: #3b82f6;
            --info-bg: rgba(59, 130, 246, 0.1);
            --wastage: #f97316;
            --wastage-bg: rgba(249, 115, 22, 0.1);
            --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.3);
            --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.4);
            --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.5);
            --glow: 0 0 40px rgba(99, 102, 241, 0.15);
            --spacing-xs: 4px;
            --spacing-sm: 8px;
            --spacing-md: 16px;
            --spacing-lg: 24px;
            --spacing-xl: 32px;
            --spacing-2xl: 48px;
            --radius-sm: 6px;
            --radius-md: 10px;
            --radius-lg: 16px;
            --radius-xl: 24px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Instrument Sans', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
            -webkit-font-smoothing: antialiased;
        }

        /* Header */
        .header {
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            padding: var(--spacing-md) var(--spacing-lg);
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(12px);
        }

        .header-content {
            max-width: 1600px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: var(--spacing-md);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: var(--accent-gradient);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 18px;
            box-shadow: var(--glow);
            flex-shrink: 0;
        }

        .logo-text {
            font-size: 18px;
            font-weight: 600;
        }

        .logo-text span {
            color: var(--text-secondary);
            font-weight: 400;
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            flex-wrap: wrap;
        }

        .sync-status {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            padding: var(--spacing-xs) var(--spacing-sm);
            background: var(--success-bg);
            border: 1px solid rgba(16, 185, 129, 0.3);
            border-radius: var(--radius-sm);
            font-size: 12px;
            color: var(--success);
        }

        .sync-dot {
            width: 6px;
            height: 6px;
            background: var(--success);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .btn {
            padding: var(--spacing-sm) var(--spacing-md);
            border-radius: var(--radius-sm);
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            border: none;
            display: flex;
            align-items: center;
            gap: var(--spacing-xs);
            white-space: nowrap;
        }

        .btn-primary {
            background: var(--accent-gradient);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: var(--glow);
        }

        .btn-secondary {
            background: var(--bg-card);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .btn-secondary:hover {
            background: var(--bg-card-hover);
        }

        .btn-sm {
            padding: var(--spacing-xs) var(--spacing-sm);
            font-size: 12px;
        }

        .btn-danger {
            background: var(--danger-bg);
            color: var(--danger);
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        .btn-warning {
            background: var(--warning-bg);
            color: var(--warning);
            border: 1px solid rgba(245, 158, 11, 0.3);
        }

        /* Tab Navigation */
        .tab-nav {
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            padding: 0 var(--spacing-lg);
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        .tab-nav::-webkit-scrollbar { display: none; }

        .tab-nav-inner {
            max-width: 1600px;
            margin: 0 auto;
            display: flex;
            gap: var(--spacing-xs);
            min-width: max-content;
        }

        .tab-btn {
            padding: var(--spacing-md) var(--spacing-lg);
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            position: relative;
            transition: all 0.2s ease;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }

        .tab-btn:hover { color: var(--text-primary); }
        .tab-btn.active { color: var(--text-primary); }

        .tab-btn.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--accent-gradient);
            border-radius: 2px 2px 0 0;
        }

        .tab-badge {
            background: var(--danger);
            color: white;
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 10px;
            font-weight: 600;
        }

        /* Main Content */
        .main-content {
            max-width: 1600px;
            margin: 0 auto;
            padding: var(--spacing-lg);
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .tab-content.active { display: block; }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Section Headers */
        .section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--spacing-md);
            flex-wrap: wrap;
            gap: var(--spacing-md);
        }

        .section-title {
            font-size: 16px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }

        .section-subtitle {
            font-size: 13px;
            color: var(--text-secondary);
            margin-top: 2px;
        }

        /* Quick Stats Row */
        .quick-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: var(--spacing-sm);
            padding: var(--spacing-md);
            background: var(--bg-secondary);
            border-radius: var(--radius-md);
            margin-bottom: var(--spacing-lg);
            border: 1px solid var(--border-color);
        }

        .quick-stat { text-align: center; padding: var(--spacing-sm); }

        .quick-stat-label {
            font-size: 11px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 2px;
        }

        .quick-stat-value {
            font-size: 18px;
            font-weight: 700;
            font-family: 'JetBrains Mono', monospace;
        }

        /* Alerts */
        .alert-section { margin-bottom: var(--spacing-xl); }
        .alert-grid { display: grid; gap: var(--spacing-md); }

        .alert-card {
            display: flex;
            align-items: flex-start;
            gap: var(--spacing-md);
            padding: var(--spacing-md);
            border-radius: var(--radius-md);
            border-left: 4px solid;
            background: var(--bg-card);
        }

        .alert-card.danger { background: var(--danger-bg); border-color: var(--danger); }
        .alert-card.warning { background: var(--warning-bg); border-color: var(--warning); }
        .alert-card.info { background: var(--info-bg); border-color: var(--info); }
        .alert-card.wastage { background: var(--wastage-bg); border-color: var(--wastage); }

        .alert-icon { font-size: 20px; flex-shrink: 0; }
        .alert-content { flex: 1; min-width: 0; }
        .alert-content h4 { font-size: 14px; font-weight: 600; margin-bottom: 2px; }
        .alert-content p { font-size: 13px; color: var(--text-secondary); }
        .alert-actions { display: flex; gap: var(--spacing-sm); margin-top: var(--spacing-sm); flex-wrap: wrap; }

        /* KPI Cards */
        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-xl);
        }

        .kpi-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: var(--spacing-md);
            transition: all 0.2s ease;
            position: relative;
            overflow: hidden;
        }

        .kpi-card:hover {
            border-color: var(--accent-primary);
            box-shadow: var(--glow);
            transform: translateY(-2px);
        }

        .kpi-card.wastage-highlight { border-color: var(--wastage); }
        .kpi-card.wastage-highlight:hover { box-shadow: 0 0 40px rgba(249, 115, 22, 0.15); }

        .kpi-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--spacing-sm);
        }

        .kpi-label {
            font-size: 12px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .kpi-icon {
            width: 32px;
            height: 32px;
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }

        .kpi-icon.blue { background: var(--info-bg); }
        .kpi-icon.green { background: var(--success-bg); }
        .kpi-icon.yellow { background: var(--warning-bg); }
        .kpi-icon.red { background: var(--danger-bg); }
        .kpi-icon.orange { background: var(--wastage-bg); }

        .kpi-value {
            font-size: 28px;
            font-weight: 700;
            font-family: 'JetBrains Mono', monospace;
            margin-bottom: var(--spacing-xs);
        }

        .kpi-change {
            display: inline-flex;
            align-items: center;
            gap: var(--spacing-xs);
            padding: 2px var(--spacing-sm);
            border-radius: var(--radius-sm);
            font-size: 11px;
            font-weight: 500;
        }

        .kpi-change.positive { background: var(--success-bg); color: var(--success); }
        .kpi-change.negative { background: var(--danger-bg); color: var(--danger); }
        .kpi-change.neutral { background: var(--warning-bg); color: var(--warning); }
        .kpi-change.wastage { background: var(--wastage-bg); color: var(--wastage); }

        /* Wastage Section */
        .wastage-section {
            background: linear-gradient(135deg, rgba(249, 115, 22, 0.05) 0%, rgba(239, 68, 68, 0.05) 100%);
            border: 1px solid var(--wastage);
            border-radius: var(--radius-lg);
            padding: var(--spacing-lg);
            margin-bottom: var(--spacing-xl);
        }

        .wastage-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--spacing-md);
            flex-wrap: wrap;
            gap: var(--spacing-md);
        }

        .wastage-title {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            font-size: 16px;
            font-weight: 600;
            color: var(--wastage);
        }

        .wastage-total {
            font-family: 'JetBrains Mono', monospace;
            font-size: 24px;
            font-weight: 700;
            color: var(--wastage);
        }

        .wastage-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: var(--spacing-md);
        }

        .wastage-item {
            background: var(--bg-card);
            border-radius: var(--radius-md);
            padding: var(--spacing-md);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .wastage-item-info h5 { font-size: 14px; font-weight: 600; margin-bottom: 2px; }
        .wastage-item-info p { font-size: 12px; color: var(--text-secondary); }

        .wastage-item-amount {
            font-family: 'JetBrains Mono', monospace;
            font-size: 16px;
            font-weight: 600;
            color: var(--wastage);
        }

        /* Decision Matrix */
        .decision-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-xl);
        }

        .decision-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: var(--spacing-lg);
        }

        .decision-card-header {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-md);
        }

        .decision-card-icon {
            width: 40px;
            height: 40px;
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .decision-card-title { font-size: 14px; font-weight: 600; }
        .decision-card-subtitle { font-size: 12px; color: var(--text-secondary); }
        .decision-list { list-style: none; }

        .decision-list li {
            padding: var(--spacing-sm) 0;
            border-bottom: 1px solid var(--border-subtle);
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 13px;
        }

        .decision-list li:last-child { border-bottom: none; }
        .decision-value { font-family: 'JetBrains Mono', monospace; font-weight: 600; }
        .decision-value.positive { color: var(--success); }
        .decision-value.negative { color: var(--danger); }
        .decision-value.warning { color: var(--warning); }

        /* Charts */
        .chart-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: var(--spacing-lg);
            margin-bottom: var(--spacing-xl);
        }

        .chart-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: var(--spacing-lg);
        }

        .chart-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--spacing-md);
        }

        .chart-title { font-size: 14px; font-weight: 600; }
        .chart-container { position: relative; height: 280px; }

        /* Tables */
        .table-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            overflow: hidden;
        }

        .table-header {
            padding: var(--spacing-md);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: var(--spacing-md);
        }

        .table-title { font-size: 14px; font-weight: 600; }
        .table-container { overflow-x: auto; -webkit-overflow-scrolling: touch; }

        table { width: 100%; border-collapse: collapse; min-width: 800px; }

        th {
            text-align: left;
            padding: var(--spacing-sm) var(--spacing-md);
            font-size: 11px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            white-space: nowrap;
        }

        td {
            padding: var(--spacing-sm) var(--spacing-md);
            font-size: 13px;
            border-bottom: 1px solid var(--border-subtle);
        }

        tr:hover td { background: var(--bg-card-hover); }
        tr.wastage-row { background: var(--wastage-bg); }
        tr.wastage-row:hover td { background: rgba(249, 115, 22, 0.15); }

        .amount { font-family: 'JetBrains Mono', monospace; font-weight: 500; }
        .amount.expense { color: var(--danger); }
        .amount.wastage { color: var(--wastage); }

        .badge {
            padding: 2px var(--spacing-sm);
            border-radius: var(--radius-sm);
            font-size: 11px;
            font-weight: 500;
            white-space: nowrap;
        }

        .badge.category { background: var(--bg-secondary); color: var(--text-secondary); }
        .badge.wastage { background: var(--wastage-bg); color: var(--wastage); }
        .badge.ok { background: var(--success-bg); color: var(--success); }
        .badge.review { background: var(--warning-bg); color: var(--warning); }

        /* Filter Bar */
        .filter-bar {
            display: flex;
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-lg);
            flex-wrap: wrap;
            align-items: flex-end;
        }

        .filter-group { display: flex; flex-direction: column; gap: var(--spacing-xs); }

        .filter-label {
            font-size: 11px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        select, input[type="date"], input[type="text"] {
            padding: var(--spacing-sm) var(--spacing-md);
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            color: var(--text-primary);
            font-size: 13px;
            min-width: 140px;
        }

        select:focus, input:focus { outline: none; border-color: var(--accent-primary); }

        /* Category Pills */
        .category-pills {
            display: flex;
            gap: var(--spacing-sm);
            flex-wrap: wrap;
            margin-bottom: var(--spacing-lg);
        }

        .category-pill {
            padding: var(--spacing-sm) var(--spacing-md);
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .category-pill:hover, .category-pill.active {
            background: var(--accent-primary);
            border-color: var(--accent-primary);
            color: white;
        }

        .category-pill.wastage { border-color: var(--wastage); }
        .category-pill.wastage:hover, .category-pill.wastage.active {
            background: var(--wastage);
            border-color: var(--wastage);
        }

        /* Budget Cards */
        .budget-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-xl);
        }

        .budget-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: var(--spacing-md);
        }

        .budget-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--spacing-sm);
        }

        .budget-category { font-size: 13px; font-weight: 600; }
        .budget-amounts { text-align: right; }
        .budget-spent { font-size: 14px; font-weight: 600; font-family: 'JetBrains Mono', monospace; }
        .budget-total { font-size: 11px; color: var(--text-secondary); }

        .progress-bar { height: 6px; background: var(--bg-secondary); border-radius: 3px; overflow: hidden; }
        .progress-fill { height: 100%; border-radius: 3px; transition: width 0.3s ease; }
        .progress-fill.green { background: var(--success); }
        .progress-fill.yellow { background: var(--warning); }
        .progress-fill.red { background: var(--danger); }

        /* Vendor Cards */
        .vendor-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-xl);
        }

        .vendor-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: var(--spacing-md);
        }

        .vendor-header {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-md);
        }

        .vendor-avatar {
            width: 44px;
            height: 44px;
            border-radius: var(--radius-md);
            background: var(--accent-gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            font-weight: 600;
            flex-shrink: 0;
        }

        .vendor-name { font-size: 14px; font-weight: 600; }
        .vendor-type { font-size: 12px; color: var(--text-secondary); }

        .vendor-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--spacing-md);
            padding-top: var(--spacing-md);
            border-top: 1px solid var(--border-color);
        }

        .vendor-stat-label { font-size: 11px; color: var(--text-secondary); }
        .vendor-stat-value { font-size: 16px; font-weight: 600; font-family: 'JetBrains Mono', monospace; }

        /* Pagination */
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: var(--spacing-sm);
            margin-top: var(--spacing-lg);
            flex-wrap: wrap;
        }

        .page-info { padding: var(--spacing-sm) var(--spacing-md); color: var(--text-secondary); font-size: 13px; }

        /* Responsive - Tablet */
        @media (max-width: 1024px) {
            .main-content { padding: var(--spacing-md); }
            .chart-grid { grid-template-columns: 1fr; }
            .decision-grid { grid-template-columns: 1fr 1fr; }
        }

        /* Responsive - Mobile */
        @media (max-width: 768px) {
            .header { padding: var(--spacing-sm) var(--spacing-md); }
            .header-content { flex-direction: column; align-items: stretch; }
            .logo { justify-content: center; }
            .header-actions { justify-content: center; }
            .tab-btn { padding: var(--spacing-sm) var(--spacing-md); font-size: 13px; }
            .main-content { padding: var(--spacing-sm); }
            .quick-stats { grid-template-columns: repeat(2, 1fr); }
            .quick-stat-value { font-size: 16px; }
            .kpi-grid { grid-template-columns: repeat(2, 1fr); }
            .kpi-value { font-size: 22px; }
            .decision-grid { grid-template-columns: 1fr; }
            .chart-grid { grid-template-columns: 1fr; }
            .chart-container { height: 220px; }
            .wastage-grid { grid-template-columns: 1fr; }
            .budget-grid { grid-template-columns: 1fr; }
            .vendor-grid { grid-template-columns: 1fr; }
            .filter-bar { flex-direction: column; }
            .filter-group { width: 100%; }
            select, input[type="date"], input[type="text"] { width: 100%; }
            .section-header { flex-direction: column; align-items: flex-start; }
            .alert-card { flex-direction: column; }
            table { min-width: 600px; }
            th, td { padding: var(--spacing-xs) var(--spacing-sm); font-size: 11px; }
        }

        /* Responsive - Small Mobile */
        @media (max-width: 480px) {
            .kpi-grid { grid-template-columns: 1fr; }
            .quick-stats { grid-template-columns: 1fr 1fr; gap: var(--spacing-xs); padding: var(--spacing-sm); }
            .quick-stat-label { font-size: 10px; }
            .quick-stat-value { font-size: 14px; }
            .logo-text { font-size: 16px; }
            .wastage-total { font-size: 20px; }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <div class="logo-icon">‚Çπ</div>
                <div class="logo-text">TBP Media <span>Expense Center</span></div>
            </div>
            <div class="header-actions">
                <div class="sync-status">
                    <span class="sync-dot"></span>
                    <span>Live</span>
                    <span id="lastSync">Now</span>
                </div>
                <button class="btn btn-secondary btn-sm" onclick="refreshData()">üîÑ Refresh</button>
                <button class="btn btn-primary btn-sm" onclick="exportData()">üì• Export</button>
            </div>
        </div>
    </header>

    <!-- Tab Navigation -->
    <nav class="tab-nav">
        <div class="tab-nav-inner">
            <button class="tab-btn active" onclick="switchTab('founder')">
                üëë Founder <span class="tab-badge" id="founderAlertCount">5</span>
            </button>
            <button class="tab-btn" onclick="switchTab('manager')">
                üìä Manager <span class="tab-badge" id="managerAlertCount">3</span>
            </button>
            <button class="tab-btn" onclick="switchTab('accounts')">
                üìã Accounts <span class="tab-badge" id="accountsAlertCount">12</span>
            </button>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        
        <!-- FOUNDER TAB -->
        <div id="founder-tab" class="tab-content active">
            
            <!-- Quick Stats Bar -->
            <div class="quick-stats">
                <div class="quick-stat">
                    <div class="quick-stat-label">FY 2025</div>
                    <div class="quick-stat-value" id="fyTotal">‚Çπ95.4L</div>
                </div>
                <div class="quick-stat">
                    <div class="quick-stat-label">This Month</div>
                    <div class="quick-stat-value" id="monthTotal">‚Çπ8.2L</div>
                </div>
                <div class="quick-stat">
                    <div class="quick-stat-label">Budget Used</div>
                    <div class="quick-stat-value">78%</div>
                </div>
                <div class="quick-stat">
                    <div class="quick-stat-label">Transactions</div>
                    <div class="quick-stat-value" id="txnCount">687</div>
                </div>
                <div class="quick-stat">
                    <div class="quick-stat-label" style="color: var(--wastage)">Wastage</div>
                    <div class="quick-stat-value" style="color: var(--wastage)" id="totalWastage">‚Çπ14.8L</div>
                </div>
            </div>

            <!-- Attention Required Section -->
            <div class="alert-section">
                <div class="section-header">
                    <div>
                        <h2 class="section-title">üö® Attention Required</h2>
                        <p class="section-subtitle">Critical items requiring your immediate decision</p>
                    </div>
                </div>
                <div class="alert-grid" id="founderAlerts">
                    <div class="alert-card danger">
                        <span class="alert-icon">üî¥</span>
                        <div class="alert-content">
                            <h4>G Suite Audit Critical - ‚Çπ11.4L</h4>
                            <p>850 accounts with Pramod, 350+ reportedly unused. Potential ‚Çπ4.7L annual savings.</p>
                            <div class="alert-actions">
                                <button class="btn btn-danger btn-sm">Audit Now</button>
                                <button class="btn btn-secondary btn-sm">Schedule Review</button>
                            </div>
                        </div>
                    </div>
                    <div class="alert-card wastage">
                        <span class="alert-icon">üü†</span>
                        <div class="alert-content">
                            <h4>Telegram Account Fraud - ‚Çπ12,750</h4>
                            <p>Fraudulent vendor identified in June. Switch to verified vendors only.</p>
                            <div class="alert-actions">
                                <button class="btn btn-warning btn-sm">Blacklist Vendor</button>
                            </div>
                        </div>
                    </div>
                    <div class="alert-card warning">
                        <span class="alert-icon">üü°</span>
                        <div class="alert-content">
                            <h4>Tools Budget Exceeded - 143%</h4>
                            <p>‚Çπ7.17L spent vs ‚Çπ5L 2026 budget. 2026 optimized plan ready: ‚Çπ3.79L.</p>
                            <div class="alert-actions">
                                <button class="btn btn-primary btn-sm">Approve 2026 Plan</button>
                            </div>
                        </div>
                    </div>
                    <div class="alert-card info">
                        <span class="alert-icon">üîµ</span>
                        <div class="alert-content">
                            <h4>Vendor Consolidation Opportunity</h4>
                            <p>35 PR vendors ‚Üí 5 core vendors could save 15-20% on rates.</p>
                            <div class="alert-actions">
                                <button class="btn btn-secondary btn-sm">View Analysis</button>
                            </div>
                        </div>
                    </div>
                    <div class="alert-card warning">
                        <span class="alert-icon">üü°</span>
                        <div class="alert-content">
                            <h4>Accesswire Package Review</h4>
                            <p>‚Çπ15.2L spent on Yahoo Finance packages. ROI analysis pending.</p>
                            <div class="alert-actions">
                                <button class="btn btn-secondary btn-sm">Request ROI Report</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Wastage Detection Section -->
            <div class="wastage-section">
                <div class="wastage-header">
                    <div class="wastage-title">‚ö†Ô∏è Identified Wastage & Optimization Potential</div>
                    <div class="wastage-total" id="founderWastageTotal">‚Çπ14.82L</div>
                </div>
                <div class="wastage-grid" id="founderWastageGrid">
                    <div class="wastage-item">
                        <div class="wastage-item-info">
                            <h5>Unused G Suite Accounts</h5>
                            <p>350 accounts @ ‚Çπ1,350/year each</p>
                        </div>
                        <div class="wastage-item-amount">‚Çπ4.72L</div>
                    </div>
                    <div class="wastage-item">
                        <div class="wastage-item-info">
                            <h5>Abandoned Tool Subscriptions</h5>
                            <p>OpenAI, Midjourney, etc. duplicates</p>
                        </div>
                        <div class="wastage-item-amount">‚Çπ3.38L</div>
                    </div>
                    <div class="wastage-item">
                        <div class="wastage-item-info">
                            <h5>Telegram Accounts Wastage</h5>
                            <p>Over-purchase + fraud incidents</p>
                        </div>
                        <div class="wastage-item-amount">‚Çπ1.8L</div>
                    </div>
                    <div class="wastage-item">
                        <div class="wastage-item-info">
                            <h5>Underutilized PR Vendors</h5>
                            <p>Low ROI publications</p>
                        </div>
                        <div class="wastage-item-amount">‚Çπ4.92L</div>
                    </div>
                </div>
            </div>

            <!-- Decision Matrix -->
            <div class="section-header">
                <div>
                    <h2 class="section-title">üéØ Decision Matrix</h2>
                    <p class="section-subtitle">Key metrics for strategic decisions</p>
                </div>
                <select id="founderPeriod" onchange="updateFounderView()">
                    <option value="2025">Full Year 2025</option>
                    <option value="q4">Q4 2025</option>
                    <option value="q3">Q3 2025</option>
                </select>
            </div>
            <div class="decision-grid">
                <div class="decision-card">
                    <div class="decision-card-header">
                        <div class="decision-card-icon" style="background: var(--success-bg)">üí∞</div>
                        <div>
                            <div class="decision-card-title">Cost vs Revenue</div>
                            <div class="decision-card-subtitle">Expense efficiency analysis</div>
                        </div>
                    </div>
                    <ul class="decision-list">
                        <li><span>Revenue 2025</span><span class="decision-value positive">‚Çπ1.15 Cr</span></li>
                        <li><span>Total Expenses</span><span class="decision-value negative">‚Çπ95.4L</span></li>
                        <li><span>Expense Ratio</span><span class="decision-value warning">83%</span></li>
                        <li><span>Net Margin</span><span class="decision-value positive">17%</span></li>
                    </ul>
                </div>
                <div class="decision-card">
                    <div class="decision-card-header">
                        <div class="decision-card-icon" style="background: var(--info-bg)">üìä</div>
                        <div>
                            <div class="decision-card-title">Category Breakdown</div>
                            <div class="decision-card-subtitle">Where money is going</div>
                        </div>
                    </div>
                    <ul class="decision-list">
                        <li><span>PR/Outsource</span><span class="decision-value">56.4%</span></li>
                        <li><span>Travel & Events</span><span class="decision-value">22.1%</span></li>
                        <li><span>Ads & Marketing</span><span class="decision-value">8.4%</span></li>
                        <li><span>Tools & Software</span><span class="decision-value">7.5%</span></li>
                    </ul>
                </div>
                <div class="decision-card">
                    <div class="decision-card-header">
                        <div class="decision-card-icon" style="background: var(--warning-bg)">üéØ</div>
                        <div>
                            <div class="decision-card-title">2026 Targets</div>
                            <div class="decision-card-subtitle">Planned optimizations</div>
                        </div>
                    </div>
                    <ul class="decision-list">
                        <li><span>Tools Budget</span><span class="decision-value positive">‚Çπ3.79L</span></li>
                        <li><span>G Suite Savings</span><span class="decision-value positive">‚Çπ4.72L</span></li>
                        <li><span>Vendor Consolidation</span><span class="decision-value positive">‚Çπ2-3L</span></li>
                        <li><span>Total Savings</span><span class="decision-value positive">‚Çπ10-12L</span></li>
                    </ul>
                </div>
                <div class="decision-card">
                    <div class="decision-card-header">
                        <div class="decision-card-icon" style="background: var(--danger-bg)">‚ö°</div>
                        <div>
                            <div class="decision-card-title">Quick Actions</div>
                            <div class="decision-card-subtitle">Pending decisions</div>
                        </div>
                    </div>
                    <ul class="decision-list">
                        <li><span>G Suite Audit</span><button class="btn btn-danger btn-sm">Action</button></li>
                        <li><span>Tools 2026 Plan</span><button class="btn btn-primary btn-sm">Approve</button></li>
                        <li><span>Vendor Review</span><button class="btn btn-secondary btn-sm">Schedule</button></li>
                        <li><span>Travel Policy</span><button class="btn btn-secondary btn-sm">Review</button></li>
                    </ul>
                </div>
            </div>

            <!-- KPI Cards -->
            <div class="section-header">
                <div>
                    <h2 class="section-title">üìà Key Metrics</h2>
                    <p class="section-subtitle">High-level expense overview</p>
                </div>
            </div>
            <div class="kpi-grid">
                <div class="kpi-card">
                    <div class="kpi-header">
                        <span class="kpi-label">Total Expenses</span>
                        <div class="kpi-icon blue">üí∞</div>
                    </div>
                    <div class="kpi-value" id="kpiTotalExpense">‚Çπ95.4L</div>
                    <span class="kpi-change neutral">vs ‚Çπ122L budget</span>
                </div>
                <div class="kpi-card">
                    <div class="kpi-header">
                        <span class="kpi-label">Outsource/PR</span>
                        <div class="kpi-icon green">üéØ</div>
                    </div>
                    <div class="kpi-value" id="kpiOutsource">‚Çπ53.8L</div>
                    <span class="kpi-change negative">56.4% of total</span>
                </div>
                <div class="kpi-card">
                    <div class="kpi-header">
                        <span class="kpi-label">Travel & Events</span>
                        <div class="kpi-icon yellow">‚úàÔ∏è</div>
                    </div>
                    <div class="kpi-value" id="kpiTravel">‚Çπ21.1L</div>
                    <span class="kpi-change neutral">22.1% of total</span>
                </div>
                <div class="kpi-card">
                    <div class="kpi-header">
                        <span class="kpi-label">Tools & Software</span>
                        <div class="kpi-icon red">üõ†Ô∏è</div>
                    </div>
                    <div class="kpi-value" id="kpiTools">‚Çπ7.17L</div>
                    <span class="kpi-change positive">-‚Çπ3.38L in 2026</span>
                </div>
                <div class="kpi-card wastage-highlight">
                    <div class="kpi-header">
                        <span class="kpi-label">Identified Wastage</span>
                        <div class="kpi-icon orange">‚ö†Ô∏è</div>
                    </div>
                    <div class="kpi-value" style="color: var(--wastage)">‚Çπ14.8L</div>
                    <span class="kpi-change wastage">15.5% recoverable</span>
                </div>
            </div>

            <!-- Charts Row -->
            <div class="chart-grid">
                <div class="chart-card">
                    <div class="chart-header">
                        <h3 class="chart-title">üìä Expense by Category</h3>
                    </div>
                    <div class="chart-container">
                        <canvas id="categoryChart"></canvas>
                    </div>
                </div>
                <div class="chart-card">
                    <div class="chart-header">
                        <h3 class="chart-title">üìà Monthly Trend</h3>
                    </div>
                    <div class="chart-container">
                        <canvas id="trendChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Budget Tracking -->
            <div class="section-header">
                <div>
                    <h2 class="section-title">üí≥ Budget vs Actual</h2>
                    <p class="section-subtitle">2026 budget tracking</p>
                </div>
            </div>
            <div class="budget-grid">
                <div class="budget-card">
                    <div class="budget-header">
                        <span class="budget-category">üéØ PR & Outsource</span>
                        <div class="budget-amounts">
                            <span class="budget-spent">‚Çπ53.8L</span>
                            <span class="budget-total">/ ‚Çπ60L</span>
                        </div>
                    </div>
                    <div class="progress-bar"><div class="progress-fill yellow" style="width: 90%"></div></div>
                </div>
                <div class="budget-card">
                    <div class="budget-header">
                        <span class="budget-category">‚úàÔ∏è Travel</span>
                        <div class="budget-amounts">
                            <span class="budget-spent">‚Çπ21.1L</span>
                            <span class="budget-total">/ ‚Çπ25L</span>
                        </div>
                    </div>
                    <div class="progress-bar"><div class="progress-fill green" style="width: 84%"></div></div>
                </div>
                <div class="budget-card">
                    <div class="budget-header">
                        <span class="budget-category">üõ†Ô∏è Tools</span>
                        <div class="budget-amounts">
                            <span class="budget-spent">‚Çπ7.17L</span>
                            <span class="budget-total">/ ‚Çπ5L (2026)</span>
                        </div>
                    </div>
                    <div class="progress-bar"><div class="progress-fill red" style="width: 100%"></div></div>
                </div>
                <div class="budget-card">
                    <div class="budget-header">
                        <span class="budget-category">üì¢ Ads</span>
                        <div class="budget-amounts">
                            <span class="budget-spent">‚Çπ8.02L</span>
                            <span class="budget-total">/ ‚Çπ10L</span>
                        </div>
                    </div>
                    <div class="progress-bar"><div class="progress-fill green" style="width: 80%"></div></div>
                </div>
            </div>
        </div>

        <!-- MANAGER TAB -->
        <div id="manager-tab" class="tab-content">
            
            <!-- Attention Required for Managers -->
            <div class="alert-section">
                <div class="section-header">
                    <div>
                        <h2 class="section-title">üö® Attention Required</h2>
                        <p class="section-subtitle">Items requiring manager review</p>
                    </div>
                </div>
                <div class="alert-grid" id="managerAlerts">
                    <div class="alert-card warning">
                        <span class="alert-icon">üü°</span>
                        <div class="alert-content">
                            <h4>High Vendor Fragmentation</h4>
                            <p>35 different PR vendors used. Consider consolidating to improve rates.</p>
                        </div>
                    </div>
                    <div class="alert-card wastage">
                        <span class="alert-icon">üü†</span>
                        <div class="alert-content">
                            <h4>Telegram Account Over-Purchase</h4>
                            <p>~1,925 accounts purchased. Audit actual usage vs purchase.</p>
                        </div>
                    </div>
                    <div class="alert-card info">
                        <span class="alert-icon">üîµ</span>
                        <div class="alert-content">
                            <h4>Email ID Setup Pending</h4>
                            <p>350 G Suite IDs paid but not set up for email marketing.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Wastage Detection for Managers -->
            <div class="wastage-section">
                <div class="wastage-header">
                    <div class="wastage-title">‚ö†Ô∏è Probable Wastage by Team/Vendor</div>
                    <div class="wastage-total">‚Çπ8.54L</div>
                </div>
                <div class="wastage-grid" id="managerWastageGrid">
                    <div class="wastage-item">
                        <div class="wastage-item-info">
                            <h5>Unused Email IDs</h5>
                            <p>350 IDs √ó ‚Çπ1,350 annual</p>
                        </div>
                        <div class="wastage-item-amount">‚Çπ4.72L</div>
                    </div>
                    <div class="wastage-item">
                        <div class="wastage-item-info">
                            <h5>Telegram Fraud + Overstock</h5>
                            <p>Fraud: ‚Çπ12.7K, Excess: ‚Çπ50K</p>
                        </div>
                        <div class="wastage-item-amount">‚Çπ62.7K</div>
                    </div>
                    <div class="wastage-item">
                        <div class="wastage-item-info">
                            <h5>Low ROI Vendors</h5>
                            <p>Publications with minimal impact</p>
                        </div>
                        <div class="wastage-item-amount">‚Çπ3.2L</div>
                    </div>
                </div>
            </div>

            <!-- Filter Bar -->
            <div class="filter-bar">
                <div class="filter-group">
                    <span class="filter-label">Category</span>
                    <select id="managerCategory" onchange="filterManagerData()">
                        <option value="all">All Categories</option>
                        <option value="Outsource/PR">Outsource/PR</option>
                        <option value="Travel">Travel</option>
                        <option value="Ads & Marketing">Ads & Marketing</option>
                        <option value="Tools & Subscriptions">Tools & Subs</option>
                        <option value="Telegram">Telegram</option>
                        <option value="G Suite">G Suite</option>
                        <option value="Content">Content</option>
                    </select>
                </div>
                <div class="filter-group">
                    <span class="filter-label">Team</span>
                    <select id="managerTeam">
                        <option value="all">All Teams</option>
                        <option value="Tarun">Tarun's Team</option>
                        <option value="Ahmad">Ahmad's Team</option>
                        <option value="Ankush">Ankush</option>
                    </select>
                </div>
                <div class="filter-group">
                    <span class="filter-label">Period</span>
                    <select id="managerPeriod">
                        <option value="all">Full Year</option>
                        <option value="q4">Q4 2025</option>
                        <option value="q3">Q3 2025</option>
                    </select>
                </div>
                <div class="filter-group">
                    <span class="filter-label">Show</span>
                    <select id="managerWastageFilter">
                        <option value="all">All Transactions</option>
                        <option value="wastage">Probable Wastage Only</option>
                        <option value="review">Needs Review</option>
                    </select>
                </div>
            </div>

            <!-- Manager KPIs with Wastage -->
            <div class="kpi-grid">
                <div class="kpi-card">
                    <div class="kpi-header">
                        <span class="kpi-label">Total Vendors</span>
                        <div class="kpi-icon blue">üè¢</div>
                    </div>
                    <div class="kpi-value">35</div>
                    <span class="kpi-change negative">High fragmentation</span>
                </div>
                <div class="kpi-card">
                    <div class="kpi-header">
                        <span class="kpi-label">Avg Transaction</span>
                        <div class="kpi-icon green">üí≥</div>
                    </div>
                    <div class="kpi-value">‚Çπ13.9K</div>
                    <span class="kpi-change neutral">687 transactions</span>
                </div>
                <div class="kpi-card">
                    <div class="kpi-header">
                        <span class="kpi-label">Top Vendor</span>
                        <div class="kpi-icon yellow">‚≠ê</div>
                    </div>
                    <div class="kpi-value">‚Çπ15.2L</div>
                    <span class="kpi-change neutral">Accesswire</span>
                </div>
                <div class="kpi-card wastage-highlight">
                    <div class="kpi-header">
                        <span class="kpi-label">Probable Wastage</span>
                        <div class="kpi-icon orange">‚ö†Ô∏è</div>
                    </div>
                    <div class="kpi-value" style="color: var(--wastage)">‚Çπ8.54L</div>
                    <span class="kpi-change wastage">Review needed</span>
                </div>
            </div>

            <!-- Vendor Analysis -->
            <div class="section-header">
                <div>
                    <h2 class="section-title">üè¢ Top Vendors</h2>
                    <p class="section-subtitle">Spend analysis by vendor</p>
                </div>
            </div>
            <div class="vendor-grid" id="vendorGrid"></div>

            <!-- Charts -->
            <div class="chart-grid">
                <div class="chart-card">
                    <div class="chart-header">
                        <h3 class="chart-title">üë§ Spend by Team Member</h3>
                    </div>
                    <div class="chart-container">
                        <canvas id="teamChart"></canvas>
                    </div>
                </div>
                <div class="chart-card">
                    <div class="chart-header">
                        <h3 class="chart-title">üìÇ Spend by Project</h3>
                    </div>
                    <div class="chart-container">
                        <canvas id="projectChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Recent Transactions Table with Wastage Column -->
            <div class="section-header">
                <div>
                    <h2 class="section-title">üìã Recent Transactions</h2>
                    <p class="section-subtitle">Last 20 expenses with wastage flags</p>
                </div>
            </div>
            <div class="table-card">
                <div class="table-container">
                    <table id="managerTransactions">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Amount</th>
                                <th>Category</th>
                                <th>Vendor</th>
                                <th>Project</th>
                                <th>Requested By</th>
                                <th>Wastage Status</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- ACCOUNTS TAB -->
        <div id="accounts-tab" class="tab-content">
            
            <!-- Attention Required for Accounts -->
            <div class="alert-section">
                <div class="section-header">
                    <div>
                        <h2 class="section-title">üö® Attention Required</h2>
                        <p class="section-subtitle">Items requiring accounts team action</p>
                    </div>
                </div>
                <div class="alert-grid" id="accountsAlerts">
                    <div class="alert-card warning">
                        <span class="alert-icon">üü°</span>
                        <div class="alert-content">
                            <h4>12 Transactions Missing Invoices</h4>
                            <p>High-value transactions without proper documentation.</p>
                        </div>
                    </div>
                    <div class="alert-card wastage">
                        <span class="alert-icon">üü†</span>
                        <div class="alert-content">
                            <h4>Duplicate Payments Detected</h4>
                            <p>3 potential duplicate transactions identified - verify and process refunds.</p>
                        </div>
                    </div>
                    <div class="alert-card info">
                        <span class="alert-icon">üîµ</span>
                        <div class="alert-content">
                            <h4>Subscription Renewals This Month</h4>
                            <p>5 annual subscriptions due for renewal - review before auto-renew.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Wastage Detection for Accounts -->
            <div class="wastage-section">
                <div class="wastage-header">
                    <div class="wastage-title">‚ö†Ô∏è Transactions Flagged as Probable Wastage</div>
                    <div class="wastage-total" id="accountsWastageTotal">12 items (‚Çπ6.2L)</div>
                </div>
            </div>

            <!-- Filter Bar -->
            <div class="filter-bar">
                <div class="filter-group">
                    <span class="filter-label">Search</span>
                    <input type="text" id="searchExpense" placeholder="Search transactions..." onkeyup="searchTransactions()">
                </div>
                <div class="filter-group">
                    <span class="filter-label">From</span>
                    <input type="date" id="dateFrom" value="2025-01-01">
                </div>
                <div class="filter-group">
                    <span class="filter-label">To</span>
                    <input type="date" id="dateTo" value="2025-12-31">
                </div>
                <div class="filter-group">
                    <span class="filter-label">Category</span>
                    <select id="accountsCategory">
                        <option value="all">All</option>
                        <option value="Outsource/PR">Outsource/PR</option>
                        <option value="Travel">Travel</option>
                        <option value="Ads & Marketing">Ads & Marketing</option>
                        <option value="Tools & Subscriptions">Tools & Subs</option>
                        <option value="Telegram">Telegram</option>
                        <option value="G Suite">G Suite</option>
                        <option value="Content">Content</option>
                        <option value="Office">Office</option>
                    </select>
                </div>
                <button class="btn btn-primary btn-sm" onclick="applyFilters()">Apply</button>
            </div>

            <!-- Category Pills with Wastage -->
            <div class="category-pills">
                <span class="category-pill active" onclick="quickFilter('all')">All</span>
                <span class="category-pill" onclick="quickFilter('Outsource/PR')">Outsource/PR</span>
                <span class="category-pill" onclick="quickFilter('Tools & Subscriptions')">Tools</span>
                <span class="category-pill" onclick="quickFilter('Travel')">Travel</span>
                <span class="category-pill" onclick="quickFilter('Ads & Marketing')">Ads</span>
                <span class="category-pill wastage" onclick="quickFilter('wastage')">Wastage</span>
            </div>

            <!-- Summary Stats with Wastage -->
            <div class="kpi-grid">
                <div class="kpi-card">
                    <div class="kpi-header">
                        <span class="kpi-label">Transactions</span>
                        <div class="kpi-icon blue">üìä</div>
                    </div>
                    <div class="kpi-value" id="accTxnCount">687</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-header">
                        <span class="kpi-label">Total Amount</span>
                        <div class="kpi-icon green">üí∞</div>
                    </div>
                    <div class="kpi-value" id="accTotalAmt">‚Çπ95.4L</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-header">
                        <span class="kpi-label">Average</span>
                        <div class="kpi-icon yellow">üìà</div>
                    </div>
                    <div class="kpi-value" id="accAvgAmt">‚Çπ13.9K</div>
                </div>
                <div class="kpi-card wastage-highlight">
                    <div class="kpi-header">
                        <span class="kpi-label">Wastage Flagged</span>
                        <div class="kpi-icon orange">‚ö†Ô∏è</div>
                    </div>
                    <div class="kpi-value" style="color: var(--wastage)" id="accWastageCount">12</div>
                    <span class="kpi-change wastage">‚Çπ6.2L total</span>
                </div>
            </div>

            <!-- Full Transaction Table with Wastage Column -->
            <div class="table-card">
                <div class="table-header">
                    <h3 class="table-title">üìã All Transactions</h3>
                    <div style="display: flex; gap: var(--spacing-sm); flex-wrap: wrap;">
                        <button class="btn btn-secondary btn-sm" onclick="downloadCSV()">üì• CSV</button>
                        <button class="btn btn-warning btn-sm" onclick="exportWastage()">‚ö†Ô∏è Export Wastage</button>
                        <button class="btn btn-primary btn-sm" onclick="addExpense()">‚ûï Add</button>
                    </div>
                </div>
                <div class="table-container">
                    <table id="accountsTable">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Amount</th>
                                <th>Category</th>
                                <th>Particular</th>
                                <th>Platform</th>
                                <th>Project</th>
                                <th>Done By</th>
                                <th>Wastage</th>
                            </tr>
                        </thead>
                        <tbody id="accountsTableBody"></tbody>
                    </table>
                </div>
            </div>

            <!-- Pagination -->
            <div class="pagination">
                <button class="btn btn-secondary btn-sm" onclick="prevPage()">‚Üê Prev</button>
                <span class="page-info">Page <span id="currentPage">1</span> of <span id="totalPages">35</span></span>
                <button class="btn btn-secondary btn-sm" onclick="nextPage()">Next ‚Üí</button>
            </div>
        </div>
    </main>

    <script>
        // ============================================
        // CONFIGURATION - YOUR GOOGLE SHEETS CREDENTIALS
        // ============================================
        const CONFIG = {
            SHEET_ID: '1oQyoxNuZveFWbA7-SNziCX5muIbX2P4-kS801Mv2_Ng',
            API_KEY: 'AIzaSyDiIA75Y8N10JpR0J5jeSy-se4WGtldV4Q',
            TRANSACTIONS_SHEET: 'Transactions',
            SUMMARY_SHEET: 'Summary',
            ITEMS_PER_PAGE: 20
        };
        const WASTAGE_RULES = { keywords: ['fraud', 'unused', 'duplicate', 'cancelled', 'refund'], flaggedVendors: ['Buy Telegram account'], highValueThreshold: 50000 };
        let allData = [], filteredData = [], currentPage = 1, chartInstances = {};

        // ============================================
        // GOOGLE SHEETS API FUNCTIONS
        // ============================================
        async function fetchSheetData(sheetName, range = '') {
            const rangeParam = range ? `!${range}` : '';
            const url = `https://sheets.googleapis.com/v4/spreadsheets/${CONFIG.SHEET_ID}/values/${sheetName}${rangeParam}?key=${CONFIG.API_KEY}`;
            try {
                const response = await fetch(url);
                if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                return await response.json();
            } catch (error) {
                console.error('Error fetching sheet data:', error);
                throw error;
            }
        }

        async function loadAllData() {
            try {
                document.getElementById('lastSync').textContent = 'Loading...';
                const txnData = await fetchSheetData(CONFIG.TRANSACTIONS_SHEET, 'A3:X1000');
                if (!txnData.values || txnData.values.length === 0) {
                    console.warn('No transaction data found');
                    allData = [];
                } else {
                    allData = txnData.values.filter(row => row[0]).map((row, index) => ({
                        date: row[0] || '',
                        amount: parseFloat(row[1]) || 0,
                        paymentType: row[2] || '',
                        category: row[3] || '',
                        particular: row[4] || '',
                        platform: row[5] || '',
                        project: row[6] || '',
                        notes: row[7] || '',
                        source: row[8] || '',
                        doneBy: row[9] || '',
                        askedBy: row[10] || '',
                        invoice: row[11] || '',
                        id: row[12] || `TXN${String(index + 1).padStart(3, '0')}`,
                        submittedAt: row[13] || '',
                        month: row[14] || '',
                        quarter: row[15] || '',
                        status: row[16] || 'Pending',
                        wastage: mapWastageStatus(row[17]),
                        wastageReason: row[18] || '',
                        approvedBy: row[19] || '',
                        reviewDate: row[20] || '',
                        reviewerNotes: row[21] || '',
                        autoFlag: row[22] || 'OK',
                        flagReason: row[23] || ''
                    }));
                }
                filteredData = [...allData];
                initFounderView(); initManagerView(); initAccountsView(); updateAlertBadges(); updateSyncStatus();
                console.log(`Loaded ${allData.length} transactions from Google Sheets`);
            } catch (error) {
                console.error('Error loading data:', error);
                document.getElementById('lastSync').textContent = 'Error!';
                alert('Failed to load data from Google Sheets.\n\nPlease check:\n1. Sheet ID is correct\n2. API Key is valid\n3. Sheet is shared as "Anyone with link can view"');
            }
        }

        function mapWastageStatus(value) {
            if (!value) return 'ok';
            const lower = value.toString().toLowerCase().trim();
            if (lower === 'wastage') return 'wastage';
            if (lower === 'review') return 'review';
            return 'ok';
        }

        document.addEventListener('DOMContentLoaded', function() {
            loadAllData();
        });

        function detectWastage(item) {
            if (item.wastage && item.wastage !== 'ok') return item.wastage;
            const particular = (item.particular || '').toLowerCase();
            const platform = (item.platform || '').toLowerCase();
            if (WASTAGE_RULES.keywords.some(kw => particular.includes(kw))) return 'wastage';
            if (WASTAGE_RULES.flaggedVendors.some(v => platform.includes(v.toLowerCase()))) return 'review';
            if (particular.includes('gsuite') || particular.includes('g suite') || particular.includes('gsuit')) return 'review';
            if (item.amount > WASTAGE_RULES.highValueThreshold && !item.project) return 'review';
            return 'ok';
        }

        function getWastageStats() {
            const wastageItems = allData.filter(d => d.wastage === 'wastage');
            const reviewItems = allData.filter(d => d.wastage === 'review');
            return { wastageCount: wastageItems.length, wastageAmount: wastageItems.reduce((sum, d) => sum + d.amount, 0), reviewCount: reviewItems.length, reviewAmount: reviewItems.reduce((sum, d) => sum + d.amount, 0), totalCount: wastageItems.length + reviewItems.length, totalAmount: wastageItems.reduce((sum, d) => sum + d.amount, 0) + reviewItems.reduce((sum, d) => sum + d.amount, 0) };
        }

        function updateAlertBadges() {
            const stats = getWastageStats();
            const pendingCount = allData.filter(d => d.status === 'Pending').length;
            const missingInvoice = allData.filter(d => !d.invoice && d.amount > 10000).length;
            document.getElementById('founderAlertCount').textContent = stats.wastageCount + pendingCount;
            document.getElementById('managerAlertCount').textContent = stats.reviewCount;
            document.getElementById('accountsAlertCount').textContent = missingInvoice + stats.totalCount;
        }

        function switchTab(tabName) {
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            event.target.closest('.tab-btn').classList.add('active');
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            document.getElementById(`${tabName}-tab`).classList.add('active');
        }

        function initFounderView() {
            const total = allData.reduce((sum, item) => sum + item.amount, 0);
            const outsource = allData.filter(d => d.category === 'Outsource/PR').reduce((sum, item) => sum + item.amount, 0);
            const travel = allData.filter(d => d.category === 'Travel').reduce((sum, item) => sum + item.amount, 0);
            const tools = allData.filter(d => d.category === 'Tools & Subscriptions').reduce((sum, item) => sum + item.amount, 0);
            const wastage = getWastageStats();
            document.getElementById('kpiTotalExpense').textContent = formatCurrency(total);
            document.getElementById('kpiOutsource').textContent = formatCurrency(outsource);
            document.getElementById('kpiTravel').textContent = formatCurrency(travel);
            document.getElementById('kpiTools').textContent = formatCurrency(tools);
            document.getElementById('fyTotal').textContent = formatCurrency(total);
            document.getElementById('txnCount').textContent = allData.length.toString();
            document.getElementById('totalWastage').textContent = formatCurrency(wastage.totalAmount);
            renderCategoryChart(); renderTrendChart();
        }

        function renderCategoryChart() {
            const ctx = document.getElementById('categoryChart').getContext('2d');
            if (chartInstances.category) chartInstances.category.destroy();
            const categoryTotals = {};
            allData.forEach(item => { if (item.category) categoryTotals[item.category] = (categoryTotals[item.category] || 0) + item.amount; });
            chartInstances.category = new Chart(ctx, { type: 'doughnut', data: { labels: Object.keys(categoryTotals), datasets: [{ data: Object.values(categoryTotals), backgroundColor: ['#6366f1', '#8b5cf6', '#ec4899', '#f59e0b', '#10b981', '#3b82f6', '#64748b'], borderWidth: 0 }] }, options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'right', labels: { color: '#8b8b9e', padding: 12, font: { size: 11 } } } } } });
        }

        function renderTrendChart() {
            const ctx = document.getElementById('trendChart').getContext('2d');
            if (chartInstances.trend) chartInstances.trend.destroy();
            const monthlyTotals = {};
            allData.forEach(item => { if (item.date) { const month = item.date.substring(0, 7); monthlyTotals[month] = (monthlyTotals[month] || 0) + item.amount; } });
            const sortedMonths = Object.keys(monthlyTotals).sort();
            const labels = sortedMonths.map(m => { const [year, month] = m.split('-'); return new Date(year, month - 1).toLocaleDateString('en', { month: 'short' }); });
            chartInstances.trend = new Chart(ctx, { type: 'line', data: { labels: labels, datasets: [{ label: 'Monthly', data: sortedMonths.map(m => monthlyTotals[m]), borderColor: '#6366f1', backgroundColor: 'rgba(99, 102, 241, 0.1)', fill: true, tension: 0.4, borderWidth: 2, pointRadius: 3 }] }, options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { x: { grid: { color: 'rgba(255,255,255,0.05)' }, ticks: { color: '#8b8b9e', font: { size: 10 } } }, y: { grid: { color: 'rgba(255,255,255,0.05)' }, ticks: { color: '#8b8b9e', font: { size: 10 }, callback: v => '‚Çπ' + (v/100000).toFixed(1) + 'L' } } } } });
        }

        function initManagerView() { renderVendorCards(); renderTeamChart(); renderProjectChart(); renderManagerTransactions(); }

        function renderVendorCards() {
            const vendorTotals = {};
            allData.forEach(item => { if (item.platform) { if (!vendorTotals[item.platform]) vendorTotals[item.platform] = { total: 0, count: 0 }; vendorTotals[item.platform].total += item.amount; vendorTotals[item.platform].count++; } });
            const sortedVendors = Object.entries(vendorTotals).sort((a, b) => b[1].total - a[1].total).slice(0, 6);
            document.getElementById('vendorGrid').innerHTML = sortedVendors.map(([vendor, stats]) => `<div class="vendor-card"><div class="vendor-header"><div class="vendor-avatar">${vendor.charAt(0).toUpperCase()}</div><div><div class="vendor-name">${vendor.length > 20 ? vendor.substring(0,20)+'...' : vendor}</div><div class="vendor-type">Vendor</div></div></div><div class="vendor-stats"><div><div class="vendor-stat-label">Total</div><div class="vendor-stat-value">${formatCurrency(stats.total)}</div></div><div><div class="vendor-stat-label">Txns</div><div class="vendor-stat-value">${stats.count}</div></div></div></div>`).join('');
        }

        function renderTeamChart() {
            const ctx = document.getElementById('teamChart').getContext('2d');
            if (chartInstances.team) chartInstances.team.destroy();
            const teamTotals = {};
            allData.forEach(item => { const team = item.doneBy || 'Unknown'; teamTotals[team] = (teamTotals[team] || 0) + item.amount; });
            chartInstances.team = new Chart(ctx, { type: 'bar', data: { labels: Object.keys(teamTotals).slice(0, 6), datasets: [{ data: Object.values(teamTotals).slice(0, 6), backgroundColor: '#6366f1', borderRadius: 4 }] }, options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { x: { grid: { display: false }, ticks: { color: '#8b8b9e', font: { size: 10 } } }, y: { grid: { color: 'rgba(255,255,255,0.05)' }, ticks: { color: '#8b8b9e', font: { size: 10 }, callback: v => '‚Çπ' + (v/100000).toFixed(1) + 'L' } } } } });
        }

        function renderProjectChart() {
            const ctx = document.getElementById('projectChart').getContext('2d');
            if (chartInstances.project) chartInstances.project.destroy();
            const projectTotals = {};
            allData.forEach(item => { const project = item.project || 'Other'; projectTotals[project] = (projectTotals[project] || 0) + item.amount; });
            const sorted = Object.entries(projectTotals).sort((a, b) => b[1] - a[1]).slice(0, 6);
            chartInstances.project = new Chart(ctx, { type: 'bar', data: { labels: sorted.map(([k]) => k.length > 15 ? k.substring(0,15)+'...' : k), datasets: [{ data: sorted.map(([, v]) => v), backgroundColor: '#8b5cf6', borderRadius: 4 }] }, options: { indexAxis: 'y', responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { x: { grid: { color: 'rgba(255,255,255,0.05)' }, ticks: { color: '#8b8b9e', font: { size: 10 }, callback: v => '‚Çπ' + (v/100000).toFixed(1) + 'L' } }, y: { grid: { display: false }, ticks: { color: '#8b8b9e', font: { size: 10 } } } } } });
        }

        function renderManagerTransactions() {
            const tbody = document.querySelector('#managerTransactions tbody');
            const recent = [...allData].sort((a, b) => new Date(b.date) - new Date(a.date)).slice(0, 20);
            tbody.innerHTML = recent.map(item => `<tr class="${item.wastage === 'wastage' ? 'wastage-row' : ''}"><td>${formatDate(item.date)}</td><td class="amount ${item.wastage === 'wastage' ? 'wastage' : 'expense'}">${formatCurrency(item.amount)}</td><td><span class="badge category">${item.category}</span></td><td>${item.platform ? (item.platform.length > 15 ? item.platform.substring(0,15)+'...' : item.platform) : '-'}</td><td>${item.project ? (item.project.length > 12 ? item.project.substring(0,12)+'...' : item.project) : '-'}</td><td>${item.askedBy || item.doneBy || '-'}</td><td><span class="badge ${item.wastage}">${getWastageBadgeText(item.wastage)}</span></td></tr>`).join('');
        }

        function initAccountsView() { renderAccountsTable(); updateAccountsStats(); }

        function renderAccountsTable() {
            const tbody = document.getElementById('accountsTableBody');
            const start = (currentPage - 1) * CONFIG.ITEMS_PER_PAGE;
            const pageData = filteredData.slice(start, start + CONFIG.ITEMS_PER_PAGE);
            tbody.innerHTML = pageData.map(item => `<tr class="${item.wastage === 'wastage' ? 'wastage-row' : ''}"><td>${formatDate(item.date)}</td><td class="amount ${item.wastage === 'wastage' ? 'wastage' : 'expense'}">${formatCurrency(item.amount)}</td><td><span class="badge category">${item.category}</span></td><td>${item.particular ? (item.particular.length > 20 ? item.particular.substring(0,20)+'...' : item.particular) : '-'}</td><td>${item.platform ? (item.platform.length > 12 ? item.platform.substring(0,12)+'...' : item.platform) : '-'}</td><td>${item.project ? (item.project.length > 10 ? item.project.substring(0,10)+'...' : item.project) : '-'}</td><td>${item.doneBy || '-'}</td><td><span class="badge ${item.wastage}">${getWastageBadgeText(item.wastage)}</span></td></tr>`).join('');
            document.getElementById('currentPage').textContent = currentPage;
            document.getElementById('totalPages').textContent = Math.ceil(filteredData.length / CONFIG.ITEMS_PER_PAGE);
        }

        function getWastageBadgeText(status) { return { 'ok': '‚úì OK', 'review': '‚ö° Review', 'wastage': '‚ö†Ô∏è Wastage' }[status] || '‚úì OK'; }

        function updateAccountsStats() {
            const total = filteredData.reduce((sum, item) => sum + item.amount, 0);
            const avg = total / filteredData.length || 0;
            const wastageCount = filteredData.filter(d => d.wastage === 'wastage' || d.wastage === 'review').length;
            document.getElementById('accTxnCount').textContent = filteredData.length;
            document.getElementById('accTotalAmt').textContent = formatCurrency(total);
            document.getElementById('accAvgAmt').textContent = formatCurrency(avg);
            document.getElementById('accWastageCount').textContent = wastageCount;
        }

        function quickFilter(category) {
            document.querySelectorAll('.category-pill').forEach(pill => pill.classList.remove('active'));
            event.target.classList.add('active');
            if (category === 'all') filteredData = [...allData];
            else if (category === 'wastage') filteredData = allData.filter(item => item.wastage === 'wastage' || item.wastage === 'review');
            else filteredData = allData.filter(item => item.category === category);
            currentPage = 1; renderAccountsTable(); updateAccountsStats();
        }

        function searchTransactions() {
            const query = document.getElementById('searchExpense').value.toLowerCase();
            filteredData = allData.filter(item => (item.particular && item.particular.toLowerCase().includes(query)) || (item.platform && item.platform.toLowerCase().includes(query)) || (item.project && item.project.toLowerCase().includes(query)));
            currentPage = 1; renderAccountsTable(); updateAccountsStats();
        }

        function applyFilters() {
            const category = document.getElementById('accountsCategory').value;
            const dateFrom = document.getElementById('dateFrom').value;
            const dateTo = document.getElementById('dateTo').value;
            filteredData = allData.filter(item => { let match = true; if (category !== 'all' && item.category !== category) match = false; if (dateFrom && item.date < dateFrom) match = false; if (dateTo && item.date > dateTo) match = false; return match; });
            currentPage = 1; renderAccountsTable(); updateAccountsStats();
        }

        function prevPage() { if (currentPage > 1) { currentPage--; renderAccountsTable(); } }
        function nextPage() { if (currentPage < Math.ceil(filteredData.length / CONFIG.ITEMS_PER_PAGE)) { currentPage++; renderAccountsTable(); } }

        function formatCurrency(amount) { if (amount >= 100000) return '‚Çπ' + (amount / 100000).toFixed(1) + 'L'; if (amount >= 1000) return '‚Çπ' + (amount / 1000).toFixed(1) + 'K'; return '‚Çπ' + amount.toFixed(0); }
        function formatDate(dateStr) { if (!dateStr) return '-'; const date = new Date(dateStr); return date.toLocaleDateString('en-IN', { day: '2-digit', month: 'short' }); }
        function refreshData() { loadAllData(); }
        function updateSyncStatus() { document.getElementById('lastSync').textContent = new Date().toLocaleTimeString('en-IN', { hour: '2-digit', minute: '2-digit' }); }

        function exportData() {
            const headers = ['Date', 'Amount', 'Category', 'Particular', 'Platform', 'Project', 'Done By', 'Wastage Status'];
            const csvContent = [headers.join(','), ...filteredData.map(item => [item.date, item.amount, item.category, item.particular, item.platform, item.project, item.doneBy, item.wastage].map(f => `"${f || ''}"`).join(','))].join('\n');
            const blob = new Blob([csvContent], { type: 'text/csv' });
            const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = 'tbp_expenses_export.csv'; a.click();
        }

        function downloadCSV() { exportData(); }

        function exportWastage() {
            const wastageData = allData.filter(d => d.wastage === 'wastage' || d.wastage === 'review');
            const headers = ['Date', 'Amount', 'Category', 'Particular', 'Platform', 'Wastage Status'];
            const csvContent = [headers.join(','), ...wastageData.map(item => [item.date, item.amount, item.category, item.particular, item.platform, item.wastage].map(f => `"${f || ''}"`).join(','))].join('\n');
            const blob = new Blob([csvContent], { type: 'text/csv' });
            const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = 'tbp_wastage_report.csv'; a.click();
        }

        function addExpense() { alert('Opens expense form. In production, connects to Google Form via n8n.'); }
        function filterManagerData() { renderManagerTransactions(); }
        function updateFounderView() { initFounderView(); }
    </script>
</body>
</html>
